"use strict";(self.webpackChunkkeybr_com=self.webpackChunkkeybr_com||[]).push([[1917],{8827:(e,t,r)=>{r.d(t,{Qe:()=>me,rc:()=>pe});class n extends Error{name="DatabaseError";constructor(e,t){super(e,t)}get[Symbol.toStringTag](){return"DatabaseError"}}var a=r(4922),o=r(2352),s=r(7810),l=r(1739);function u(e){const[t,r]=(0,s.useState)({type:"loading",total:0,current:0});return(0,s.useEffect)((()=>{let t=!1;return(async()=>{const n=await e.load(((e,n)=>{t||r({type:"loading",total:e,current:n})}));t||r({type:"ready",results:n})})().catch(l.WL),()=>{t=!0}}),[e]),t}var i=r(5176);function c(e){console.error(e),"true"===process.env.REPORT_ERRORS&&l.$p.toast((0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"Oh no! Database error!"}),(0,a.jsx)("p",{children:"This is likely a temporary problem and will be resolved soon."})]}),e)}function d({storage:e,initialResults:t,children:r}){const[n,o]=(0,s.useState)(t);return(0,a.jsx)(i.De.Provider,{value:{results:n,appendResults:t=>{o([...n,...t]),e.append(t).catch(c)},clearResults:()=>{o([]),e.clear().catch(c)}},children:r})}var h=r(8591),m=r(5283);class p extends Error{name="InvalidFormatError";constructor(e,t){super(e,t)}get[Symbol.toStringTag](){return"InvalidFormatError"}}var f=r(699);const g=1262836034,b=(new f.AU).putInt32(g).putInt32(2).buffer();function y(e,t){const r=[...t.histogram];e.putUint8(t.layout.xid),e.putUint8(t.textType.xid),e.putUint32(Math.round(t.timeStamp/1e3)),e.putUintVlq(t.time),e.putUintVlq(t.length),e.putUintVlq(t.errors),e.putUintVlq(r.length);for(const t of r)e.putUintVlq(t.codePoint),e.putUintVlq(t.hitCount),e.putUintVlq(t.missCount),e.putUintVlq(t.timeToType)}function w(e){const t=e.getUint8(),r=e.getUint8(),n=1e3*e.getUint32(),a=e.getUintVlq(),o=e.getUintVlq(),s=e.getUintVlq(),l=e.getUintVlq(),u=[];for(let t=0;t<l;t++){const t=e.getUintVlq(),r=e.getUintVlq(),n=e.getUintVlq(),a=e.getUintVlq();u.push({codePoint:t,hitCount:r,missCount:n,timeToType:a})}return new i.Q7(h.PE.ALL.xget(t),i.M2.ALL.xget(r),n,o,a,s,new m.dq(u))}function*x(e){if(e.remaining()>0){if(!function(e){return e.remaining()>=b.byteLength&&e.getUint32()===g&&2===e.getUint32()}(e))throw new p("Invalid header");try{yield*function*(e){for(;e.remaining()>0;)yield w(e)}(e)}catch(e){throw new p("Invalid data format",{cause:e})}}}var E=r(8767);function S(e){return{l:e.layout.id,m:e.textType.id,ts:e.timeStamp,n:e.length,t:e.time,e:e.errors,h:I(e.histogram)}}function I(e){const t={};for(const{codePoint:r,hitCount:n,missCount:a,timeToType:o}of e)t[r]={h:n,m:a,t:o};return t}function D(e){if(!(0,E.Qd)(e))return null;const{l:t,m:r,ts:n,n:a,t:o,e:s,h:l}=e;if(!((0,E.Kg)(t)&&(0,E.Kg)(r)&&Number.isSafeInteger(n)&&Number.isSafeInteger(a)&&Number.isSafeInteger(o)&&Number.isSafeInteger(s)))return null;const u=function(e){if(!(0,E.Qd)(e))return null;const t=[];for(const[r,n]of Object.entries(e)){const e=Number(r);if(!(Number.isSafeInteger(e)&&e>0&&e<=65535))return null;if(!(0,E.Qd)(n))return null;const{h:a,m:o,t:s}=n;if(!(Number.isSafeInteger(a)&&Number.isSafeInteger(o)&&Number.isFinite(s)))return null;t.push({codePoint:e,hitCount:a,missCount:o,timeToType:Math.round(s)})}return new m.dq(t)}(l);if(null==u)return null;try{return new i.Q7(h.PE.ALL.get(function(e){switch(e){case"be":return h.PE.BE_BY.id;case"cz":return h.PE.CS_CZ.id;case"de":return h.PE.DE_DE.id;case"fr":return h.PE.FR_FR.id;case"it":return h.PE.IT_IT.id;case"pl":return h.PE.PL_PL.id;case"ru":return h.PE.RU_RU.id;case"se":return h.PE.SV_SE.id;case"ua":return h.PE.UK_UA.id;case"uk":return h.PE.EN_UK.id;case"us":return h.PE.EN_US.id;case"us-canary-matrix":return h.PE.EN_CANARY_MATRIX.id;case"us-colemak":return h.PE.EN_COLEMAK.id;case"us-colemak-dh":return h.PE.EN_COLEMAK_DH_ANSI.id;case"us-colemak-dh-matrix":return h.PE.EN_COLEMAK_DH_MATRIX.id;case"us-dvorak":return h.PE.EN_DVORAK.id;case"us-workman":return h.PE.EN_WORKMAN.id;default:return e}}(t)),i.M2.ALL.get(function(e){switch(e){case"guided":return i.M2.GENERATED.id;case"custom":return i.M2.NATURAL.id;default:return e}}(r)),n,a,o,s,u)}catch{return null}}function U(e){const t=new f.AU;return t.putBuffer(b),function(e,t){for(const r of t)y(e,r)}(t,e),(0,f.C1)(t.buffer())}class A extends Error{name="AbortedError";constructor(e,t){super(e,t)}get[Symbol.toStringTag](){return"AbortedError"}}class P extends Error{name="BlockedError";constructor(e,t){super(e,t)}get[Symbol.toStringTag](){return"BlockedError"}}class v{#e;#t;#r;constructor(e,t,r){this.#e=t,this.#t=r,this.#r=new T(e)}get name(){return this.#e}get version(){return this.#t}openDatabase(e){return this.#r.openDatabase(this.#e,this.#t,e)}deleteDatabase(){return this.#r.deleteDatabase(this.#e)}get[Symbol.toStringTag](){return"DBNamedFactory"}}class T{#r;constructor(e){this.#r=e}openDatabase(e,t,r){const n=this.#r.open(e,t);return new Promise(((e,t)=>{n.onerror=e=>{console.error("IndexedDB open database error",n.error),t(n.error)},n.onblocked=e=>{t(new P("Database is blocked"))},n.onupgradeneeded=a=>{const o=new C(n.result),s=new N(n.transaction);r(o,s,a.oldVersion,a.newVersion).then((()=>s.completed)).then((()=>{e(o)}),(e=>{t(e)}))},n.onsuccess=t=>{const r=new C(n.result);e(r)}}))}deleteDatabase(e){const t=this.#r.deleteDatabase(e);return new Promise(((e,r)=>{t.onerror=e=>{console.error("IndexedDB delete database error",t.error),r(t.error)},t.onblocked=e=>{r(new P("Database is blocked"))},t.onsuccess=t=>{e()}}))}get[Symbol.toStringTag](){return"DBFactory"}}class C{#n;constructor(e){this.#n=e}get name(){return this.#n.name}get version(){return this.#n.version}get objectStoreNames(){return Array.from(this.#n.objectStoreNames)}createObjectStore(e,t){return new _(this.#n.createObjectStore(e,t))}deleteObjectStore(e){this.#n.deleteObjectStore(e)}transaction(e,t,r){return new N(this.#n.transaction(e,t,r))}close(){this.#n.close()}get[Symbol.toStringTag](){return"DBDatabase"}}class N{#a;completed;constructor(e){this.#a=e,this.completed=function(e){return new Promise(((t,r)=>{e.onerror=t=>{console.error("IndexedDB transaction error",e.error),r(e.error)},e.onabort=e=>{r(new A("Operation aborted"))},e.oncomplete=e=>{t()}}))}(e)}get mode(){return this.#a.mode}get durability(){return this.#a.durability}get error(){return this.#a.error}abort(){this.#a.abort()}commit(){this.#a.commit()}objectStore(e){return new _(this.#a.objectStore(e))}get[Symbol.toStringTag](){return"DBTransaction"}}class _{#o;constructor(e){this.#o=e}get name(){return this.#o.name}get autoIncrement(){return this.#o.autoIncrement}get indexNames(){return Array.from(this.#o.indexNames)}get keyPath(){return this.#o.keyPath}createIndex(e,t,r){return new k(this.#o.createIndex(e,t,r))}deleteIndex(e){this.#o.deleteIndex(e)}index(e){return new k(this.#o.index(e))}count(e){return j(this.#o.count(e))}get(e){return j(this.#o.get(e))}getAll(e,t){return j(this.#o.getAll(e,t))}getAllKeys(e,t){return j(this.#o.getAllKeys(e,t))}add(e,t){return j(this.#o.add(e,t))}put(e,t){return j(this.#o.put(e,t))}delete(e){return j(this.#o.delete(e))}clear(){return j(this.#o.clear())}openCursor(e,t){return j(this.#o.openCursor(e,t))}openKeyCursor(e,t){return j(this.#o.openKeyCursor(e,t))}readAll(e,t,r){return R(e,this.#o.openCursor(t,r))}get[Symbol.toStringTag](){return"DBObjectStore"}}class k{#s;constructor(e){this.#s=e}get name(){return this.#s.name}get keyPath(){return this.#s.keyPath}get multiEntry(){return this.#s.multiEntry}get unique(){return this.#s.unique}count(e){return j(this.#s.count(e))}get(e){return j(this.#s.get(e))}getAll(e,t){return j(this.#s.getAll(e,t))}getAllKeys(e,t){return j(this.#s.getAllKeys(e,t))}openCursor(e,t){return j(this.#s.openCursor(e,t))}openKeyCursor(e,t){return j(this.#s.openKeyCursor(e,t))}readAll(e,t,r){return R(e,this.#s.openCursor(t,r))}get[Symbol.toStringTag](){return"DBIndex"}}function j(e){return new Promise(((t,r)=>{e.onerror=t=>{console.error("IndexedDB request error",e.error),r(e.error)},e.onsuccess=r=>{t(e.result)}}))}function R(e,t){return new Promise(((r,n)=>{const a=[];t.onerror=e=>{n(t.error)},t.onsuccess=n=>{const o=t.result;if(null!=o){const t=e(o.key,o.value);null!=t&&a.push(t),o.continue()}else r(a)}}))}class q{#r=new v(indexedDB,"history",1);async load(){const e=await this.#r.openDatabase(V);try{const t=e.transaction(e.name,"readonly"),r=t.objectStore(e.name),n=await r.readAll(((e,t)=>D(t)));return await t.completed,n}finally{e.close()}}async append(e){const t=await this.#r.openDatabase(V);try{const r=t.transaction(t.name,"readwrite"),n=r.objectStore(t.name);for(const t of e)await n.add(S(t));await r.completed}finally{t.close()}}async clear(){return await this.#r.deleteDatabase()}}async function V(e,t,r,n){e.createObjectStore(e.name,{autoIncrement:!0})}const B=268435455,O=new RegExp("^example([1-9])$"),K=95732639,L=173219789,M=86497679,F=13182319,Q=36,$="0123456789abcdefghijklmnopqrstuvwxyz",z=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0,1,2,3,4,5,6,7,8,9,null,null,null,null,null,null,null,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,null,null,null,null,null,null,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,null,null,null,null,null];class G extends Error{constructor(){super("invalid id")}get[Symbol.toStringTag](){return"InvalidIdError"}}class H{static example1=H.of("example1");static example2=H.of("example2");static example3=H.of("example3");static example4=H.of("example4");static example5=H.of("example5");static examples=[H.example1,H.example2,H.example3,H.example4,H.example5];static of(e){const t=O.exec(e);return new H(null!=t?-Number(t[1]):function(e){return t=function(e){let t=0,r=0;const n=X(e,0);for(let n=1;n<e.length;n++){const a=X(e,n);t=t*Q+a,r+=a*Y(e.length-n)}if(0===t||n!==r%Q)throw new G;return t}(e),t-=K,t=W(t^=L,F),t&=B;var t}(e))}static parse(e){try{return H.of(e)}catch{return null}}id;publicId;example;constructor(e){if(!Number.isInteger(e)||0===e)throw new G;if(e<0)this.id=-e,this.publicId="example"+-e,this.example=!0;else{if(e<1||e>B)throw new G;this.id=e,this.publicId=function(e){return function(e){let t="",r=0;do{const n=e%Q;t=$[n]+t,r+=n*Y(t.length)}while((e=e/Q>>>0)>0);return t=$[r%Q]+t,t}(function(e){return e=W(e,M),e^=L,e&=B,e+=K,e}(e))}(e),this.example=!1}}toString(){return this.publicId}toUser(){if(!this.example)throw new Error;return Object.freeze({id:this.publicId,name:`Example User ${this.id}`,imageUrl:null,premium:!1})}}function W(e,t){e>>>=0,t>>>=0;let r=0;for(let n=0;n<32;n++)1==(t>>>n&1)&&(r+=e<<n);return r>>>0}function X(e,t){const r=z[e.charCodeAt(t)];if(null==r)throw new G;return r}function Y(e){return 1&e?3:1}var Z=r(9414);const J=r.p+"671d8806404484c6.stats",ee=r.p+"ed529c0744ac1483.stats",te=r.p+"f6a87761542659fa.stats",re=r.p+"2c1f5e9498a78045.stats",ne=r.p+"140e6a6297032ddd.stats",ae="/_/sync/data";class oe{receive(e){return le(ae,e)}send(e,t){return async function(e,t,r){const n=U(t),a=await Z.Em.POST(e).on("upload-progress",(e=>{r(e.total??0,e.loaded)})).send(n,"application/octet-stream");await a.blob()}(ae,e,t)}clear(){return async function(e){const t=await Z.Em.DELETE(e).send();await t.blob()}(ae)}}class se{#l;constructor(e){this.#l=e}receive(e){return le(function(e){switch(e){case H.example1.publicId:return J;case H.example2.publicId:return ee;case H.example3.publicId:return te;case H.example4.publicId:return re;case H.example5.publicId:return ne;default:return`${ae}/${encodeURIComponent(e)}`}}(this.#l),e)}async send(e,t){throw new Error("Disabled")}async clear(){throw new Error("Disabled")}}async function le(e,t){const r=await Z.Em.use((0,Z.eA)("application/octet-stream")).GET(e).on("download-progress",(e=>{t(e.total??0,e.loaded)})).send();return[...(n=new Uint8Array(await r.arrayBuffer()),x(new f.mP(n)))];var n}function ue(e){return t=function(e){switch(e.type){case"private":{const{userId:t}=e;if(null==t){const e=new q;return new ie(e)}{const e=new q,t=new oe;return new ce(e,t)}}case"public":{const{userId:t}=e,r=new se(t);return new de(r)}}}(e),function(e){return new class{async load(t){try{return await e.load(t)}catch(e){throw new n("Cannot read records from database",{cause:e})}}async append(t,r){try{await e.append(t,r)}catch(e){throw new n("Cannot add records to database",{cause:e})}}async clear(){try{await e.clear()}catch(e){throw new n("Cannot clear database",{cause:e})}}}}(function(e){return new class{async load(t){return(0,i.lv)(await e.load(t))}async append(t,r){(t=t.filter(i.Q7.isValid)).length>0&&await e.append(t,r)}async clear(){await e.clear()}}}(t));var t}class ie{#u;constructor(e){this.#u=e}async load(e=he){return await this.#u.load()}async append(e,t=he){await this.#u.append(e)}async clear(){await this.#u.clear()}}class ce{#u;#i;constructor(e,t){this.#u=e,this.#i=t}async load(e=he){const t=await this.#i.receive(e);if(t.length>0)return t;{const t=await this.#u.load();if(t.length>0)return await this.#i.send(t,e),await this.#u.clear(),t}return[]}async append(e,t=he){await this.#i.send(e,t)}async clear(){await this.#i.clear()}}class de{#i;constructor(e){this.#i=e}async load(e=he){return await this.#i.receive(e)}async append(e,t=he){throw new Error("Disabled")}async clear(){throw new Error("Disabled")}}function he(e,t){}function me({user:e,children:t}){const r=(n=e.id,(0,s.useMemo)((()=>ue({type:"public",userId:n})),[n]));var n;const l=u(r);return"loading"===l.type?(0,a.jsx)(o.e2,{total:l.total,current:l.current}):(0,a.jsx)(d,{storage:r,initialResults:l.results,children:t})}function pe({children:e}){const t=function(){const e=(0,o.BV)();return(0,s.useMemo)((()=>{const{publicUser:t}=e;return ue({type:"private",userId:t.id})}),[e])}(),r=u(t);return"loading"===r.type?(0,a.jsx)(o.e2,{total:r.total,current:r.current}):(0,a.jsx)(d,{storage:t,initialResults:r.results,children:e})}}}]);
//# sourceMappingURL=b840bd98d30bd241.js.map