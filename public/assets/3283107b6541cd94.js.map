{"version":3,"file":"3283107b6541cd94.js","mappings":"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","sources":["webpack://keybr.com/./packages/page-layouts/lib/custom/CustomLayoutDesignerToggler.tsx","webpack://keybr.com/./packages/page-layouts/lib/KeyFrequencyHeatmap.tsx","webpack://keybr.com/./packages/keybr-pages-browser/lib/pages/layouts.tsx","webpack://keybr.com/./packages/page-layouts/lib/LayoutsPage.tsx","webpack://keybr.com/./packages/keybr-phonetic-model-loader/lib/loader.ts","webpack://keybr.com/./packages/keybr-phonetic-model-loader/lib/assets.ts","webpack://keybr.com/./packages/keybr-phonetic-model-loader/lib/PhoneticModelLoader.tsx"],"sourcesContent":["import { Button, Field, FieldList, Spacer } from \"@keybr/widget\";\nimport { lazy, Suspense, useState } from \"react\";\n\nconst LazyCustomLayoutDesigner = lazy(\n  () => import(\"./LazyCustomLayoutDesigner.tsx\"),\n);\n\nexport function CustomLayoutDesignerToggler() {\n  const [visible, setVisible] = useState(false);\n  if (visible) {\n    return (\n      <Suspense>\n        <LazyCustomLayoutDesigner />\n        <Spacer size={3} />\n      </Suspense>\n    );\n  } else {\n    return (\n      <>\n        <FieldList>\n          <Field.Filler />\n          <Button\n            onClick={() => {\n              setVisible(true);\n            }}\n          >\n            Design a custom layout\n          </Button>\n          <Field.Filler />\n        </FieldList>\n        <Spacer size={3} />\n      </>\n    );\n  }\n}\n","import {\n  computeStats,\n  type Keyboard,\n  useFormattedNames,\n} from \"@keybr/keyboard\";\nimport {\n  HeatmapLayer,\n  KeyboardStats,\n  KeyLayer,\n  TransitionsLayer,\n  VirtualKeyboard,\n} from \"@keybr/keyboard-ui\";\nimport { type PhoneticModel } from \"@keybr/phonetic-model\";\nimport { Header, Para } from \"@keybr/widget\";\nimport { type ReactNode } from \"react\";\n\nexport function KeyFrequencyHeatmap({\n  keyboard,\n  model,\n}: {\n  readonly keyboard: Keyboard;\n  readonly model: PhoneticModel;\n}): ReactNode {\n  const { formatLayoutName } = useFormattedNames();\n  const ngram1 = model.ngram1();\n  const ngram2 = model.ngram2();\n  const stats = computeStats(keyboard, ngram1, ngram2);\n  return (\n    <>\n      <Header level={2}>{formatLayoutName(keyboard.layout)}</Header>\n\n      <KeyboardStats stats={stats} />\n\n      <Para>\n        <VirtualKeyboard keyboard={keyboard}>\n          <KeyLayer />\n          <HeatmapLayer histogram={ngram1} modifier=\"f\" />\n          <TransitionsLayer histogram={ngram2} modifier=\"f\" />\n        </VirtualKeyboard>\n      </Para>\n    </>\n  );\n}\n","import { LayoutsPage } from \"@keybr/page-layouts\";\n\nexport default LayoutsPage;\n","import {\n  Language,\n  Layout,\n  loadKeyboard,\n  useFormattedNames,\n} from \"@keybr/keyboard\";\nimport { Alphabet } from \"@keybr/phonetic-model\";\nimport { PhoneticModelLoader } from \"@keybr/phonetic-model-loader\";\nimport { Article, Field, FieldList, OptionList } from \"@keybr/widget\";\nimport { useState } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { CustomLayoutDesignerToggler } from \"./custom/CustomLayoutDesignerToggler.tsx\";\nimport { KeyFrequencyHeatmap } from \"./KeyFrequencyHeatmap.tsx\";\n\nexport function LayoutsPage() {\n  const { formatLanguageName } = useFormattedNames();\n  const [language, setLanguage] = useState(Language.EN);\n  const keyboards = Layout.ALL.filter(\n    (layout) => layout.language === language,\n  ).map((layout) => loadKeyboard(layout));\n  return (\n    <Article>\n      <CustomLayoutDesignerToggler />\n      <FormattedMessage\n        id=\"page.layouts.content\"\n        defaultMessage={\n          \"<h1>Keyboard Layouts</h1>\" +\n          \"<p>These charts visualize the efficiency of different keyboard layouts. An efficiency is a measure of how easy it is to type on a keyboard.</p>\" +\n          \"<p>The circles show relative key frequencies, and the arcs show relative key pair frequencies.</p>\" +\n          \"<p>It is easier to type when the most frequent keys are on the home row, and when the most frequent key pairs are typed with different fingers and hands. Therefore an efficient layout has the largest circles on the home row. It also has arcs that are evenly distributed across the keyboard, long and horizontal, rather than short and diagonal, because it indicates the frequent switching of fingers and hands.</p>\"\n        }\n      />\n      <dl>\n        <dt>\n          <FormattedMessage\n            id=\"layouts.stats.homeRowKeys.name\"\n            defaultMessage=\"Keys on the home row:\"\n          />\n        </dt>\n        <dd>\n          <FormattedMessage\n            id=\"layouts.stats.homeRowKeys.description\"\n            defaultMessage=\"The percentage of keys typed without leaving the Caps Lock row, the more the better.\"\n          />\n        </dd>\n        <dt>\n          <FormattedMessage\n            id=\"layouts.stats.topRowKeys.name\"\n            defaultMessage=\"Keys on the top row:\"\n          />\n        </dt>\n        <dd>\n          <FormattedMessage\n            id=\"layouts.stats.topRowKeys.description\"\n            defaultMessage=\"The percentage of keys typed on the Tab row, the less the better.\"\n          />\n        </dd>\n        <dt>\n          <FormattedMessage\n            id=\"layouts.stats.bottomRowKeys.name\"\n            defaultMessage=\"Keys on the bottom row:\"\n          />\n        </dt>\n        <dd>\n          <FormattedMessage\n            id=\"layouts.stats.bottomRowKeys.description\"\n            defaultMessage=\"The percentage of keys typed on the Shift row, the less the better.\"\n          />\n        </dd>\n        <dt>\n          <FormattedMessage\n            id=\"layouts.stats.sameHandKeys.name\"\n            defaultMessage=\"Keys typed by the same hand:\"\n          />\n        </dt>\n        <dd>\n          <FormattedMessage\n            id=\"layouts.stats.sameHandKeys.description\"\n            defaultMessage=\"The percentage of keys typed by the same hand, the less the better.\"\n          />\n        </dd>\n        <dt>\n          <FormattedMessage\n            id=\"layouts.stats.sameFingerKeys.name\"\n            defaultMessage=\"Keys typed by the same finger:\"\n          />\n        </dt>\n        <dd>\n          <FormattedMessage\n            id=\"layouts.stats.sameFingerKeys.description\"\n            defaultMessage=\"The percentage of keys typed by the same finger, the less the better.\"\n          />\n        </dd>\n      </dl>\n      <FieldList>\n        <Field>\n          <FormattedMessage\n            id=\"page.layouts.language\"\n            defaultMessage=\"Language:\"\n          />\n        </Field>\n        <Field>\n          <OptionList\n            options={Language.ALL.map((item) => ({\n              name: formatLanguageName(item),\n              value: item.id,\n            }))}\n            value={language.id}\n            onSelect={(id) => {\n              setLanguage(Language.ALL.get(id));\n            }}\n          />\n        </Field>\n      </FieldList>\n      <PhoneticModelLoader language={language}>\n        {(model) => {\n          return (\n            <>\n              <FieldList>\n                <Field>\n                  <FormattedMessage\n                    id=\"page.layouts.alphabet\"\n                    defaultMessage=\"Alphabet:\"\n                  />\n                </Field>\n                <Field>\n                  <Alphabet model={model} />\n                </Field>\n              </FieldList>\n              {keyboards.map((keyboard) => (\n                <KeyFrequencyHeatmap\n                  key={keyboard.layout.id}\n                  keyboard={keyboard}\n                  model={model}\n                />\n              ))}\n            </>\n          );\n        }}\n      </PhoneticModelLoader>\n    </Article>\n  );\n}\n","import { type Language } from \"@keybr/keyboard\";\nimport {\n  censor,\n  makePhoneticModel,\n  type PhoneticModel,\n} from \"@keybr/phonetic-model\";\nimport { expectType, request } from \"@keybr/request\";\nimport { modelAssetPath } from \"./assets.ts\";\n\nexport const loaderImpl: PhoneticModel.Loader = async (\n  language: Language,\n): Promise<PhoneticModel> => {\n  const response = await request\n    .use(expectType(\"application/octet-stream\"))\n    .GET(modelAssetPath(language))\n    .send();\n  const body = await response.arrayBuffer();\n  const model = makePhoneticModel(language, new Uint8Array(body));\n  return censor(model);\n};\n","import { Language } from \"@keybr/keyboard\";\nimport AR from \"@keybr/phonetic-model/assets/model-ar.data\";\nimport BE from \"@keybr/phonetic-model/assets/model-be.data\";\nimport CS from \"@keybr/phonetic-model/assets/model-cs.data\";\nimport DE from \"@keybr/phonetic-model/assets/model-de.data\";\nimport EL from \"@keybr/phonetic-model/assets/model-el.data\";\nimport EN from \"@keybr/phonetic-model/assets/model-en.data\";\nimport ES from \"@keybr/phonetic-model/assets/model-es.data\";\nimport FA from \"@keybr/phonetic-model/assets/model-fa.data\";\nimport FR from \"@keybr/phonetic-model/assets/model-fr.data\";\nimport HE from \"@keybr/phonetic-model/assets/model-he.data\";\nimport HR from \"@keybr/phonetic-model/assets/model-hr.data\";\nimport HU from \"@keybr/phonetic-model/assets/model-hu.data\";\nimport IT from \"@keybr/phonetic-model/assets/model-it.data\";\nimport LT from \"@keybr/phonetic-model/assets/model-lt.data\";\nimport NB from \"@keybr/phonetic-model/assets/model-nb.data\";\nimport NL from \"@keybr/phonetic-model/assets/model-nl.data\";\nimport PL from \"@keybr/phonetic-model/assets/model-pl.data\";\nimport PT from \"@keybr/phonetic-model/assets/model-pt.data\";\nimport RO from \"@keybr/phonetic-model/assets/model-ro.data\";\nimport RU from \"@keybr/phonetic-model/assets/model-ru.data\";\nimport SL from \"@keybr/phonetic-model/assets/model-sl.data\";\nimport SV from \"@keybr/phonetic-model/assets/model-sv.data\";\nimport TH from \"@keybr/phonetic-model/assets/model-th.data\";\nimport TR from \"@keybr/phonetic-model/assets/model-tr.data\";\nimport UK from \"@keybr/phonetic-model/assets/model-uk.data\";\n\nexport function modelAssetPath(language: Language): string {\n  switch (language) {\n    case Language.AR:\n      return AR;\n    case Language.BE:\n      return BE;\n    case Language.CS:\n      return CS;\n    case Language.DE:\n      return DE;\n    case Language.EL:\n      return EL;\n    case Language.EN:\n      return EN;\n    case Language.ES:\n      return ES;\n    case Language.FA:\n      return FA;\n    case Language.FR:\n      return FR;\n    case Language.HE:\n      return HE;\n    case Language.HR:\n      return HR;\n    case Language.HU:\n      return HU;\n    case Language.IT:\n      return IT;\n    case Language.LT:\n      return LT;\n    case Language.NB:\n      return NB;\n    case Language.NL:\n      return NL;\n    case Language.PL:\n      return PL;\n    case Language.PT:\n      return PT;\n    case Language.RO:\n      return RO;\n    case Language.RU:\n      return RU;\n    case Language.SL:\n      return SL;\n    case Language.SV:\n      return SV;\n    case Language.TH:\n      return TH;\n    case Language.TR:\n      return TR;\n    case Language.UK:\n      return UK;\n    default:\n      throw new Error();\n  }\n}\n","import { catchError } from \"@keybr/debug\";\nimport { type Language } from \"@keybr/keyboard\";\nimport { LoadingProgress } from \"@keybr/pages-shared\";\nimport {\n  type PhoneticModel,\n  PhoneticModelContext,\n} from \"@keybr/phonetic-model\";\nimport { type ReactNode, useEffect, useState } from \"react\";\nimport { loaderImpl } from \"./loader.ts\";\n\nexport function PhoneticModelLoader({\n  language,\n  children,\n  fallback = <LoadingProgress />,\n}: {\n  readonly language: Language;\n  readonly children: (result: PhoneticModel) => ReactNode;\n  readonly fallback?: ReactNode;\n}): ReactNode {\n  return (\n    <Loader key={language.id} language={language} fallback={fallback}>\n      {children}\n    </Loader>\n  );\n}\n\nexport namespace PhoneticModelLoader {\n  export let loader: PhoneticModel.Loader = loaderImpl;\n}\n\nfunction Loader({\n  language,\n  children,\n  fallback,\n}: {\n  readonly language: Language;\n  readonly children: (result: PhoneticModel) => ReactNode;\n  readonly fallback?: ReactNode;\n}): ReactNode {\n  const result = useLoader(language);\n  if (result == null) {\n    return fallback;\n  } else {\n    return (\n      <PhoneticModelContext.Provider value={result}>\n        {children(result)}\n      </PhoneticModelContext.Provider>\n    );\n  }\n}\n\nfunction useLoader(language: Language): PhoneticModel | null {\n  const [result, setResult] = useState<PhoneticModel | null>(null);\n\n  useEffect(() => {\n    let didCancel = false;\n\n    PhoneticModelLoader.loader(language)\n      .then((result) => {\n        if (!didCancel) {\n          setResult(result);\n        }\n      })\n      .catch(catchError);\n\n    return () => {\n      didCancel = true;\n    };\n  }, [language]);\n\n  return result;\n}\n"],"names":["LazyCustomLayoutDesigner","lazy","CustomLayoutDesignerToggler","visible","setVisible","useState","Suspense","Spacer","size","FieldList","Filler","Button","onClick","KeyFrequencyHeatmap","keyboard","model","formatLayoutName","ngram1","ngram2","stats","Header","level","layout","Para","histogram","modifier","formatLanguageName","language","setLanguage","EN","keyboards","ALL","filter","map","Article","OptionList","options","item","name","value","id","onSelect","get","loaderImpl","async","response","use","GET","AR","BE","CS","DE","EL","ES","FA","FR","HE","HR","HU","IT","LT","NB","NL","PL","PT","RO","RU","SL","SV","TH","TR","UK","Error","modelAssetPath","send","body","arrayBuffer","Uint8Array","PhoneticModelLoader","children","fallback","Loader","result","setResult","useEffect","didCancel","loader","then","catch","useLoader","Provider"],"sourceRoot":""}